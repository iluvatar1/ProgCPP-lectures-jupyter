
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Numerical Integration &#8212; Introduction to C++ and Numerical Methods</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-examples.css?v=e236af4b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css?v=03b9d5b1" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/js/hoverxref.js"></script>
    <script src="../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../_static/js/micromodal.min.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-DX59QS1P22"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-DX59QS1P22');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-DX59QS1P22');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '03-integration/NumericalIntegration_Basics';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modern arrays" href="../04-vector-containers/ModernArrays.html" />
    <link rel="prev" title="Numerical differentiation" href="../02-derivatives/NumericalDifferentiation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="https://upload.wikimedia.org/wikipedia/commons/1/18/ISO_C%2B%2B_Logo.svg" class="logo__image only-light" alt="Introduction to C++ and Numerical Methods - Home"/>
    <script>document.write(`<img src="https://upload.wikimedia.org/wikipedia/commons/1/18/ISO_C%2B%2B_Logo.svg" class="logo__image only-dark" alt="Introduction to C++ and Numerical Methods - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Introduction to C++ and Numerical Methods
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to C++</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01-IntroCPP/IntroProgrammingCourse.html">Introduction to Programming and C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-IntroCPP/Resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-IntroCPP/CPP-FastPacedIntro.html">Very fast intro to the basics of c++</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numerical Calculus</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../02-derivatives/NumericalDifferentiation.html">Numerical differentiation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Numerical Integration</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modern and primitive arrays, and basic Linear Algebra</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../04-vector-containers/ModernArrays.html">Modern arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-matrixI/2D-matrices-to-1D-arrays.html">1D Arrays for 2D Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06-ArrayComputing/ArrayComputing-Valarray.html">Vector operations: Coefficient-wise , array computing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Algebra and Numerical Libraries</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../07-LinearAlgebra/LinearAlgebraEigen.html">Linear Systems : Matrices, Vectors, eigen systems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ordinary differential equations: Initial value problems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../08-ODE-IVP/InitialValueProblem.html">Ordinary differential equations (and initial value problems)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09-ODE-IVP-OOP-MolecularDynamics/IntroMolecularDynamics.html">Introduction to molecular dynamics through OOP</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Random Numbers and Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../10-RandomSystems/RandomNumbers.html">Random Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10-RandomSystems/RandomNumbersInSimulations.html">Random numbers in simulations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../11-IntroPython/01-IntroProgrammingPython.html">Python Programming (very fast) Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11-IntroPython/02-IntroProgrammingPython-DataStructs.html">Basic data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11-IntroPython/03-matplotlib-intro.html">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11-IntroPython/04-numpy-basic-reduced.html">Efficient Python arrays : Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11-IntroPython/05-Scipy.html">SciPy - Library of scientific algorithms for Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../A-01-Git/VersionControlGit.html">Git introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../A-02-Containers/Docker.html">Docker Containers - Introductory Lesson</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/iluvatar1/ProgCPP-lectures-jupyter/master?urlpath=lab/tree/03-integration/NumericalIntegration_Basics.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/iluvatar1/ProgCPP-lectures-jupyter/blob/master/03-integration/NumericalIntegration_Basics.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/iluvatar1/ProgCPP-lectures-jupyter" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/iluvatar1/ProgCPP-lectures-jupyter/issues/new?title=Issue%20on%20page%20%2F03-integration/NumericalIntegration_Basics.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/03-integration/NumericalIntegration_Basics.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Numerical Integration</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trapezoidal-rule">Trapezoidal rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simpsons-rule">Simpsons rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#romberg-method">Romberg method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#other-techniques">Other techniques</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-quadrature-introduction-to-vectors">Gaussian quadrature: Introduction to vectors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deduction-of-points-and-weights-for-the-2-point-gauss-legendre-method">Deduction of points and weights for the 2 point Gauss-Legendre method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#method-1-the-exactness-method">Method 1: The Exactness Method</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#method-2-using-legendre-polynomials">Method 2: Using Legendre Polynomials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scalling-integration-intervals">Scalling integration intervals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-order-gauss-legendre-using-a-vector-to-store-the-weights-points">Higher order Gauss-Legendre: using a vector to store the weights/points.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gauss-quadrature-of-order-7">Gauss quadrature of order 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cumulative-probability">Cumulative probability</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#di-logarithm-function">Di-logarithm function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#moment-distribution">Moment distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arch-lenght-mass-centroid">Arch lenght, mass, centroid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-a-datafile">Integrating a datafile</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="numerical-integration">
<h1>Numerical Integration<a class="headerlink" href="#numerical-integration" title="Link to this heading">#</a></h1>
<p>Computing a numerical integral (or quadrature <a class="reference external" href="https://en.wikipedia.org/wiki/Numerical_integration?useskin=vector">https://en.wikipedia.org/wiki/Numerical_integration?useskin=vector</a>) is a typical problem that appears everywhere in numerical computing. The simple task of computing the error function, <span class="math notranslate nohighlight">\(f(x) = \int_{0}^x e^{-t^2}\)</span>, requires the application of numerical techniques to calculate this (improper integral) over an arbitrary range.</p>
<p>In any numerical computing course you will start by exploring the trapezoidal and the simpsons rule. Here we are jus going to give the general formulation and then go directly to the functions given by scipy</p>
<p>Let’s compare several of the typical algorithms: <a class="reference external" href="https://www.geogebra.org/m/WsZgaJcc">https://www.geogebra.org/m/WsZgaJcc</a>, and a beautiful visualization at <a class="reference external" href="https://www.youtube.com/watch?v=FnJqaIESC2s">https://www.youtube.com/watch?v=FnJqaIESC2s</a></p>
<p>All numerical quadratures can be written as</p>
<div class="amsmath math notranslate nohighlight" id="equation-a437d9bc-9365-4009-ba5a-13e644121ab3">
<span class="eqno">(8)<a class="headerlink" href="#equation-a437d9bc-9365-4009-ba5a-13e644121ab3" title="Permalink to this equation">#</a></span>\[\begin{equation}
\int_a^b dx\  f(x) \simeq \sum_i w_i f(x_i) \Delta x + \epsilon,
\end{equation}\]</div>
<p>where the weights <span class="math notranslate nohighlight">\(w_i\)</span> and the error <span class="math notranslate nohighlight">\(\epsilon\)</span> depend on the method chosen (see <a class="reference external" href="https://en.wikipedia.org/wiki/Newton%E2%80%93Cotes_formulas?useskin=vector">https://en.wikipedia.org/wiki/Newton–Cotes_formulas?useskin=vector</a>).</p>
<section id="trapezoidal-rule">
<h2>Trapezoidal rule<a class="headerlink" href="#trapezoidal-rule" title="Link to this heading">#</a></h2>
<p>Here the function between two points is approximated by a straight line and the te area covered by the trapezoid is added up. See: <a class="reference external" href="https://en.wikipedia.org/wiki/Trapezoidal_rule">https://en.wikipedia.org/wiki/Trapezoidal_rule</a></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><img alt="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d1/Integration_num_trapezes_notation.svg/330px-Integration_num_trapezes_notation.svg.png" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d1/Integration_num_trapezes_notation.svg/330px-Integration_num_trapezes_notation.svg.png" /></p></th>
<th class="head"><p><img alt="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Trapezium2.gif/330px-Trapezium2.gif" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Trapezium2.gif/330px-Trapezium2.gif" /></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1-order interpolation</p></td>
<td><p>Better results for more intervals</p></td>
</tr>
</tbody>
</table>
</div>
<p>Between two points, the integral is approximated as</p>
<div class="amsmath math notranslate nohighlight" id="equation-c231f419-3107-4194-b2af-bae62a029eab">
<span class="eqno">(9)<a class="headerlink" href="#equation-c231f419-3107-4194-b2af-bae62a029eab" title="Permalink to this equation">#</a></span>\[\begin{equation}
I (a, b) = \int_a^b dx \ f(x) \simeq \frac{b-a}{2} (f(a) + f(b)) + O_{local}(\Delta x^3),
\end{equation}\]</div>
<p>where the weights are <span class="math notranslate nohighlight">\({1/2, 1/2}\)</span>.</p>
<p>The integral between two points, <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, after dividing its length in <span class="math notranslate nohighlight">\(N\)</span> intervals (N+1 points, regular partition) of size <span class="math notranslate nohighlight">\(\Delta x = \dfrac{b-a}{N}\)</span>, is given by</p>
<div class="math notranslate nohighlight">
\[
\int_a^b f(x) dx \simeq \Delta x \left( \frac{f(x_0)}{2} + \sum_{k=1}^{N-1} f(x_k) +\frac{f(x_N)}{2}\right) + O_{global}(\Delta x^{2}),
\]</div>
<p>where <span class="math notranslate nohighlight">\(x_k = x_0 + k \Delta x\)</span>, <span class="math notranslate nohighlight">\(x_0 = a\)</span>, and <span class="math notranslate nohighlight">\(x_N=b\)</span>. The local error is accumulated <span class="math notranslate nohighlight">\(N\)</span> times, so <span class="math notranslate nohighlight">\(O_{global} = N O_{local} = N*(b-a)/N^3 = (b-a)/N^2 = O_{global}(N^{-2}) = O_{global}(\Delta x^{2}) \)</span>.</p>
<div class="exercise admonition" id="03-integration/NumericalIntegration_Basics-exercise-0">

<p class="admonition-title"><span class="caption-number">Exercise 1 </span></p>
<section id="exercise-content">
<p>Now, please create a function to compute the integral of a function (<span class="math notranslate nohighlight">\(x^2\)</span>) using the trapezoid algorithm.</p>
<p>OPTIONAL: Write the declaration and implementation on in <code class="docutils literal notranslate"><span class="pre">integration.h</span></code> and <code class="docutils literal notranslate"><span class="pre">integration.cpp</span></code>, respectively.</p>
<p>It must fulfill the following tests</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">trapezoid</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">trapezoid</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">trapezoid</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mi">10000000</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>with results</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">0</span>.3350000000000001
<span class="m">0</span>.33333349999999995
<span class="m">0</span>.33333333333333487
</pre></div>
</div>
<p>where fun is the square function.</p>
</section>
</div>
<div class="exercise admonition" id="03-integration/NumericalIntegration_Basics-exercise-1">

<p class="admonition-title"><span class="caption-number">Exercise 2 </span></p>
<section id="exercise-content">
<p>Now use your implementation to compute the error function as a function of <span class="math notranslate nohighlight">\(x\)</span>, using the partition shown. Your program must print also the relative error, comparing with the “exact” value from <a class="reference external" href="https://en.cppreference.com/w/cpp/numeric/math/erf">https://en.cppreference.com/w/cpp/numeric/math/erf</a> . Print your data to <code class="docutils literal notranslate"><span class="pre">erf_data.txt</span></code> (print the x value, the numerical value of the integral, and the relative error)</p>
<div class="amsmath math notranslate nohighlight" id="equation-e327af28-50d9-4076-92f7-a5740bf116b7">
<span class="eqno">(10)<a class="headerlink" href="#equation-e327af28-50d9-4076-92f7-a5740bf116b7" title="Permalink to this equation">#</a></span>\[\begin{equation}
f(x) = \frac{2}{\sqrt{\pi}}\int_0^x e^{-t^2} dt
\end{equation}\]</div>
<p><span class="math notranslate nohighlight">\(x \in [0, 10]\)</span>, <span class="math notranslate nohighlight">\(\Delta x = 0.1\)</span></p>
<p><span class="math notranslate nohighlight">\(f(x=0), f(x=0+0.1), f(x=0+2\times 0.1), f(x=0+3\times 0.1), \ldots\)</span></p>
</section>
</div>
<p>You can use the following python script as a template script to plot the data</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>  
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;poster&#39;</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">erf</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;erf_data.txt&#39;</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">erf</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;err function&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;relative error&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="simpsons-rule">
<h2>Simpsons rule<a class="headerlink" href="#simpsons-rule" title="Link to this heading">#</a></h2>
<p>In this case, the method uses three discrete points and approximate the function as a parabola (second order polynomial), to improve the numerical integral computation. See: <a class="reference external" href="https://en.wikipedia.org/wiki/Simpson%27s_rule">https://en.wikipedia.org/wiki/Simpson’s_rule</a></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><a class="reference internal" href="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Simpsons_method_illustration.svg/440px-Simpsons_method_illustration.svg.png"><img alt="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Simpsons_method_illustration.svg/440px-Simpsons_method_illustration.svg.png" src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Simpsons_method_illustration.svg/440px-Simpsons_method_illustration.svg.png" style="width: 300px;" /></a></p></th>
<th class="head"><p><img alt="https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Simpsonsrule2.gif/440px-Simpsonsrule2.gif" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Simpsonsrule2.gif/440px-Simpsonsrule2.gif" /></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2-order interpolation</p></td>
<td><p>Better results for more intervals</p></td>
</tr>
</tbody>
</table>
</div>
<p>Between two points, the integral is</p>
<div class="amsmath math notranslate nohighlight" id="equation-d39d9fcc-d771-4ba0-a42c-8a4d379a6960">
<span class="eqno">(11)<a class="headerlink" href="#equation-d39d9fcc-d771-4ba0-a42c-8a4d379a6960" title="Permalink to this equation">#</a></span>\[\begin{equation}
I(a, b, 2) = \int_a^b dx\ f(x) \simeq \frac{b-a}{6} \left[ f(a) + 4f(\frac{a+b}{2}) + f(b)\right] + O_{local}(\Delta x^5),
\end{equation}\]</div>
<p>so the weights are <span class="math notranslate nohighlight">\(\{1/6, 4/6, 1/6\}\)</span>.</p>
<p>Now, using a partition,  you compute the integral as</p>
<div class="amsmath math notranslate nohighlight" id="equation-1b0255b8-b719-4878-b16d-0e0f5c0e7720">
<span class="eqno">(12)<a class="headerlink" href="#equation-1b0255b8-b719-4878-b16d-0e0f5c0e7720" title="Permalink to this equation">#</a></span>\[\begin{equation}
\int_a^b f(x) dx \simeq \frac{\Delta x}{3}\left( f(x_0) + 4 \sum_{k=1}^{N/2} f(x_{2k-1}) + 2\sum_{k=1}^{N/2-1} f(x_{2k}) + f(x_N)\right) + O_{global}(N^{-4}).
\end{equation}\]</div>
<p>Notice that <span class="math notranslate nohighlight">\(N\)</span> must be even, and <span class="math notranslate nohighlight">\(\Delta x = \dfrac{b-a}{N}\)</span>, so <span class="math notranslate nohighlight">\(O_{global}(\Delta x^4) = O_{global}(N^{-4})\)</span>.</p>
<p>Now let’s implement it. Please add a new function to the <code class="docutils literal notranslate"><span class="pre">integration.*</span></code> files , that implements the simpsons rule.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">simpson</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>Should give</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="m">0</span>.3333333333333333
</pre></div>
</div>
</section>
<section id="romberg-method">
<h2>Romberg method<a class="headerlink" href="#romberg-method" title="Link to this heading">#</a></h2>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Romberg%27s_method">Romberg Method</a> applies Richardson extrapolation to the given integration technique. The implementation is completely analogous as for the derivatives case.</p>
<div class="exercise admonition" id="03-integration/NumericalIntegration_Basics-exercise-2">

<p class="admonition-title"><span class="caption-number">Exercise 3 </span></p>
<section id="exercise-content">
<p>Implement it for the previous method shown and compare the errors as a function of <span class="math notranslate nohighlight">\(N\)</span>, the number of intervals. Use the err function and fix <span class="math notranslate nohighlight">\(x = 0.54432\)</span>.</p>
</section>
</div>
<section id="other-techniques">
<h3>Other techniques<a class="headerlink" href="#other-techniques" title="Link to this heading">#</a></h3>
<p>There are ways to improve the previous algorithms to decrease the error: using  higher order decompositions, using <a class="reference external" href="https://en.wikipedia.org/wiki/Adaptive_Simpson%27s_method">Adaptative techniques</a>, using <a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_quadrature">Gaussian quadrature</a>, mixing some of these techniques, etc. But implementing those methods by hand would be a daunting task.</p>
<p>NOTE: When you have tabular data, you will be almost forced to use either the trapezoid or the simpsons method. You could also first interpolate the data and then integrate.</p>
</section>
</section>
<section id="gaussian-quadrature-introduction-to-vectors">
<h2>Gaussian quadrature: Introduction to vectors<a class="headerlink" href="#gaussian-quadrature-introduction-to-vectors" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_quadrature?useskin=vector">Gaussian quadrature</a> is a very clever technique that allows to compute integrals with a high precision and minimal number of points. First, notice that any numerical integral method can be written as</p>
<div class="amsmath math notranslate nohighlight" id="equation-457c04fc-3e76-488e-884d-4f3c2f2ab2cc">
<span class="eqno">(13)<a class="headerlink" href="#equation-457c04fc-3e76-488e-884d-4f3c2f2ab2cc" title="Permalink to this equation">#</a></span>\[\begin{equation}
I(a, b) \simeq \sum w_k f(x_k) \Delta x,
\end{equation}\]</div>
<p>where the partition size can be <span class="math notranslate nohighlight">\(\Delta x = \dfrac{b-a}{N}\)</span> and</p>
<div class="amsmath math notranslate nohighlight" id="equation-f89d5868-f891-479a-91f2-f02a6f252bb4">
<span class="eqno">(14)<a class="headerlink" href="#equation-f89d5868-f891-479a-91f2-f02a6f252bb4" title="Permalink to this equation">#</a></span>\[\begin{equation}
x_k = a + k \Delta x .
\end{equation}\]</div>
<p>Notice that the points coordinates are fixed. Here <span class="math notranslate nohighlight">\(x_k\)</span> are the evaluation points and <span class="math notranslate nohighlight">\(w_k\)</span> the associated weights.</p>
<p>For example, going back to the previous techniques, the trapezoid rule can be written as (<span class="math notranslate nohighlight">\(N=1\)</span>)</p>
<div class="amsmath math notranslate nohighlight" id="equation-ae58a494-8b26-4621-9752-a1a9caba969b">
<span class="eqno">(15)<a class="headerlink" href="#equation-ae58a494-8b26-4621-9752-a1a9caba969b" title="Permalink to this equation">#</a></span>\[\begin{equation}
I (a, b) = \int_a^b dx \ f(x) \simeq \frac{b-a}{2} (f(a) + f(b)),
\end{equation}\]</div>
<p>so we have</p>
<ul class="simple">
<li><p>weights: <span class="math notranslate nohighlight">\(w = \{ 1/2, 1/2\}\)</span></p></li>
<li><p>points: <span class="math notranslate nohighlight">\(x = \{a, b\}\)</span>.</p></li>
</ul>
<p>And for Simpsons rule we have (minimum two points)</p>
<div class="amsmath math notranslate nohighlight" id="equation-7f687d0d-1219-4e24-8138-e6afa9fe4c1f">
<span class="eqno">(16)<a class="headerlink" href="#equation-7f687d0d-1219-4e24-8138-e6afa9fe4c1f" title="Permalink to this equation">#</a></span>\[\begin{equation}
I(a, b) = \int_a^b dx\ f(x) \simeq \frac{b-a}{6} \left[ f(a) + 4f(\frac{a+b}{2}) + f(b)\right],
\end{equation}\]</div>
<p>so we have</p>
<ul class="simple">
<li><p>weights: <span class="math notranslate nohighlight">\(w = \{1/6, 4/6, 1/6\}\)</span></p></li>
<li><p>points: <span class="math notranslate nohighlight">\(\{a, (a+b)/2, b\}\)</span>.</p></li>
</ul>
<p>What if you don’t fix the <span class="math notranslate nohighlight">\(x_i\)</span> to a uniform spacing, but, instead, try to compute both their optimal positions plus the optimal weights so you compute exactly the integral for an interpolating polynomial of degree <span class="math notranslate nohighlight">\(2n-1\)</span>, using <span class="math notranslate nohighlight">\(n\)</span> points? that is the basic idea behind the Gaussian quadrature method. The modern formulation, thanks to Jacobi, uses orthogonal polynomials, usually in the [-1, 1] domain (<strong>so you need to re-scale your data when you are integrating from <span class="math notranslate nohighlight">\([a, b]\)</span></strong>). For instace using just to points will give an integral exact up to a polynomial of degree 3. <strong>Just two points …</strong></p>
<div style="text-align: center;">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/93/Comparison_Gaussquad_trapezoidal.svg/660px-Comparison_Gaussquad_trapezoidal.svg.png" alt="Image Description" width="600">
    <figcaption>From: "https://upload.wikimedia.org/wikipedia/commons/thumb/9/93/Comparison_Gaussquad_trapezoidal.svg/660px-Comparison_Gaussquad_trapezoidal.svg.png"</figcaption>
</div>
<p>In this image, it is illustrated that although the Gaussian method uses only two points, it is exact since the integration is done on a 3-degree polynomial. Here, the integrand is <span class="math notranslate nohighlight">\(y(x) = 7x^3 -8x^2 -rx -3\)</span>  . The exact integral value is 2/3. The trapezoid method, using two points, gives -10, forcing to use the composite trapezoid method, using much more numbers. The Gauss-Legendre, with just points (strategically chosen), gives the exact value.</p>
<section id="deduction-of-points-and-weights-for-the-2-point-gauss-legendre-method">
<h3>Deduction of points and weights for the 2 point Gauss-Legendre method<a class="headerlink" href="#deduction-of-points-and-weights-for-the-2-point-gauss-legendre-method" title="Link to this heading">#</a></h3>
<p>The two-point rule approximates an integral as:
$<span class="math notranslate nohighlight">\(\int_{-1}^{1} f(x) \,dx \approx w_0 f(x_0) + w_1 f(x_1)\)</span><span class="math notranslate nohighlight">\(
We need to find the four unknown parameters: the weights **\)</span>w_0, w_1<span class="math notranslate nohighlight">\(** and the points **\)</span>x_0, x_1<span class="math notranslate nohighlight">\(**. We can do this by requiring the formula to be perfectly accurate for polynomials of the highest possible degree, which for four unknowns is degree 3 (\)</span>2n-1 = 2(2)-1 = 3$).</p>
<hr class="docutils" />
<section id="method-1-the-exactness-method">
<h4>Method 1: The Exactness Method<a class="headerlink" href="#method-1-the-exactness-method" title="Link to this heading">#</a></h4>
<p>This method involves creating a system of equations by enforcing that the approximation is exact for <span class="math notranslate nohighlight">\(f(x) = 1, x, x^2,\)</span> and <span class="math notranslate nohighlight">\(x^3\)</span>.</p>
<ol class="arabic simple">
<li><p><strong>For <span class="math notranslate nohighlight">\(f(x) = 1\)</span> (Degree 0):</strong></p>
<ul class="simple">
<li><p><strong>Exact Integral:</strong> <span class="math notranslate nohighlight">\(\int_{-1}^{1} 1 \,dx = 2\)</span></p></li>
<li><p><strong>Approximation:</strong> <span class="math notranslate nohighlight">\(w_0(1) + w_1(1) = w_0 + w_1\)</span></p></li>
<li><p><strong>Equation 1:</strong> <span class="math notranslate nohighlight">\(w_0 + w_1 = 2\)</span></p></li>
</ul>
</li>
<li><p><strong>For <span class="math notranslate nohighlight">\(f(x) = x\)</span> (Degree 1):</strong></p>
<ul class="simple">
<li><p><strong>Exact Integral:</strong> <span class="math notranslate nohighlight">\(\int_{-1}^{1} x \,dx = 0\)</span></p></li>
<li><p><strong>Approximation:</strong> <span class="math notranslate nohighlight">\(w_0(x_0) + w_1(x_1)\)</span></p></li>
<li><p><strong>Equation 2:</strong> <span class="math notranslate nohighlight">\(w_0 x_0 + w_1 x_1 = 0\)</span></p></li>
</ul>
</li>
<li><p><strong>For <span class="math notranslate nohighlight">\(f(x) = x^2\)</span> (Degree 2):</strong></p>
<ul class="simple">
<li><p><strong>Exact Integral:</strong> <span class="math notranslate nohighlight">\(\int_{-1}^{1} x^2 \,dx = \frac{2}{3}\)</span></p></li>
<li><p><strong>Approximation:</strong> <span class="math notranslate nohighlight">\(w_0(x_0^2) + w_1(x_1^2)\)</span></p></li>
<li><p><strong>Equation 3:</strong> <span class="math notranslate nohighlight">\(w_0 x_0^2 + w_1 x_1^2 = \frac{2}{3}\)</span></p></li>
</ul>
</li>
<li><p><strong>For <span class="math notranslate nohighlight">\(f(x) = x^3\)</span> (Degree 3):</strong></p>
<ul class="simple">
<li><p><strong>Exact Integral:</strong> <span class="math notranslate nohighlight">\(\int_{-1}^{1} x^3 \,dx = 0\)</span></p></li>
<li><p><strong>Approximation:</strong> <span class="math notranslate nohighlight">\(w_0(x_0^3) + w_1(x_1^3)\)</span></p></li>
<li><p><strong>Equation 4:</strong> <span class="math notranslate nohighlight">\(w_0 x_0^3 + w_1 x_1^3 = 0\)</span></p></li>
</ul>
</li>
</ol>
<p>Now, we solve this system. Due to the symmetry of the interval <span class="math notranslate nohighlight">\([-1, 1]\)</span>, we can assume a symmetric solution where <strong><span class="math notranslate nohighlight">\(w_0 = w_1\)</span></strong> and <strong><span class="math notranslate nohighlight">\(x_1 = -x_0\)</span></strong>.</p>
<ul class="simple">
<li><p>From Equation 1: If <span class="math notranslate nohighlight">\(w_0=w_1\)</span>, then <span class="math notranslate nohighlight">\(w_0 + w_0 = 2 \implies 2w_0 = 2 \implies \mathbf{w_0 = 1}\)</span>. Consequently, <strong><span class="math notranslate nohighlight">\(w_1 = 1\)</span></strong>.</p></li>
<li><p>This solution (<span class="math notranslate nohighlight">\(w_0=w_1=1\)</span> and <span class="math notranslate nohighlight">\(x_1=-x_0\)</span>) automatically satisfies Equations 2 and 4.</p></li>
<li><p>Finally, we use Equation 3 to find the points:
$<span class="math notranslate nohighlight">\(w_0 x_0^2 + w_1 x_1^2 = \frac{2}{3}\)</span><span class="math notranslate nohighlight">\(
  \)</span><span class="math notranslate nohighlight">\((1) x_0^2 + (1) (-x_0)^2 = \frac{2}{3}\)</span><span class="math notranslate nohighlight">\(
  \)</span><span class="math notranslate nohighlight">\(x_0^2 + x_0^2 = \frac{2}{3}\)</span><span class="math notranslate nohighlight">\(
  \)</span><span class="math notranslate nohighlight">\(2x_0^2 = \frac{2}{3} \implies x_0^2 = \frac{1}{3}\)</span><span class="math notranslate nohighlight">\(
  This gives the two points: **\)</span>x_0 = -\frac{1}{\sqrt{3}}<span class="math notranslate nohighlight">\(** and **\)</span>x_1 = \frac{1}{\sqrt{3}}$**.</p></li>
</ul>
</section>
<section id="method-2-using-legendre-polynomials">
<h4>Method 2: Using Legendre Polynomials<a class="headerlink" href="#method-2-using-legendre-polynomials" title="Link to this heading">#</a></h4>
<p>A more general method states that for an <span class="math notranslate nohighlight">\(n\)</span>-point rule, the points <span class="math notranslate nohighlight">\(x_i\)</span> are the roots of the <span class="math notranslate nohighlight">\(n\)</span>-th degree Legendre Polynomial, <span class="math notranslate nohighlight">\(P_n(x)\)</span>.</p>
<p>For our two-point rule, <span class="math notranslate nohighlight">\(n=2\)</span>. The second-degree Legendre Polynomial is:
$<span class="math notranslate nohighlight">\(P_2(x) = \frac{1}{2}(3x^2 - 1)\)</span><span class="math notranslate nohighlight">\(
Finding the roots means setting \)</span>P_2(x) = 0<span class="math notranslate nohighlight">\(:
\)</span><span class="math notranslate nohighlight">\(\frac{1}{2}(3x^2 - 1) = 0 \implies 3x^2 = 1 \implies x = \pm \frac{1}{\sqrt{3}}\)</span><span class="math notranslate nohighlight">\(
This confirms our points: **\)</span>x_0 = -1/\sqrt{3}<span class="math notranslate nohighlight">\(** and **\)</span>x_1 = 1/\sqrt{3}$**.</p>
<p>The corresponding weights <span class="math notranslate nohighlight">\(w_i\)</span> are calculated with the formula:
$<span class="math notranslate nohighlight">\(w_i = \frac{2}{(1-x_i^2)[P'_n(x_i)]^2}\)</span><span class="math notranslate nohighlight">\(
First, we need the derivative of \)</span>P_2(x)<span class="math notranslate nohighlight">\(:
\)</span><span class="math notranslate nohighlight">\(P'_2(x) = \frac{d}{dx}\left[\frac{1}{2}(3x^2 - 1)\right] = 3x\)</span>$
Now we compute the weights:</p>
<ul class="simple">
<li><p>For <strong><span class="math notranslate nohighlight">\(x_0 = -1/\sqrt{3}\)</span></strong>:
<span class="math notranslate nohighlight">\(w_0 = \frac{2}{(1-(-1/\sqrt{3})^2)[3(-1/\sqrt{3})]^2} = \frac{2}{(1-1/3)[-\sqrt{3}]^2} = \frac{2}{(2/3)(3)} = \mathbf{1}\)</span></p></li>
<li><p>For <strong><span class="math notranslate nohighlight">\(x_1 = 1/\sqrt{3}\)</span></strong>:
<span class="math notranslate nohighlight">\(w_1 = \frac{2}{(1-(1/\sqrt{3})^2)[3(1/\sqrt{3})]^2} = \frac{2}{(1-1/3)[\sqrt{3}]^2} = \frac{2}{(2/3)(3)} = \mathbf{1}\)</span></p></li>
</ul>
</section>
<section id="summary">
<h4>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h4>
<p>For the two-point Gauss-Legendre quadrature, the 0-indexed points and weights are:</p>
<ul class="simple">
<li><p><strong>Weights:</strong> <span class="math notranslate nohighlight">\(w_0 = 1\)</span>, <span class="math notranslate nohighlight">\(w_1 = 1\)</span></p></li>
<li><p><strong>Points:</strong> <span class="math notranslate nohighlight">\(x_0 = -\frac{1}{\sqrt{3}}\)</span>, <span class="math notranslate nohighlight">\(x_1 = \frac{1}{\sqrt{3}}\)</span></p></li>
</ul>
<p>The final approximation formula is:
$<span class="math notranslate nohighlight">\(\int_{-1}^{1} f(x) \,dx \approx (1)f\left(-\frac{1}{\sqrt{3}}\right) + (1)f\left(\frac{1}{\sqrt{3}}\right)\)</span>$</p>
<div class="exercise admonition" id="03-integration/NumericalIntegration_Basics-exercise-3">

<p class="admonition-title"><span class="caption-number">Exercise 4 </span> (Gauss-Legendre quadrature with 2 points)</p>
<section id="exercise-content">
<p>For the Gauss-Legendre formulation, you can check the weights at <a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_quadrature?useskin=vector#Gauss%E2%80%93Legendre_quadrature">https://en.wikipedia.org/wiki/Gaussian_quadrature?useskin=vector#Gauss–Legendre_quadrature</a>. Interpret the table. Now implement the 2 point Gauss-Legendre quadrature and test the figure results.</p>
</section>
</div>
<div class="exercise admonition" id="03-integration/NumericalIntegration_Basics-exercise-4">

<p class="admonition-title"><span class="caption-number">Exercise 5 </span></p>
<section id="exercise-content">
<p>Can Richardson extrapolation be applied to the Gauss quadrature method?</p>
</section>
</div>
</section>
</section>
</section>
<section id="scalling-integration-intervals">
<h2>Scalling integration intervals<a class="headerlink" href="#scalling-integration-intervals" title="Link to this heading">#</a></h2>
<p>To successfully apply the Gaussian quadrature technique to a general integral on the interval [a, b], we need to map it to the interval [-1, 1]. Basically you want a new <span class="math notranslate nohighlight">\(x'\)</span> such that <span class="math notranslate nohighlight">\(x = a\)</span> (<span class="math notranslate nohighlight">\(b\)</span>) when <span class="math notranslate nohighlight">\(x' = 1\)</span> (-1). Once such linear mapping is</p>
<div class="amsmath math notranslate nohighlight" id="equation-e8f716c2-13fe-44ca-814b-e5b0f52315af">
<span class="eqno">(17)<a class="headerlink" href="#equation-e8f716c2-13fe-44ca-814b-e5b0f52315af" title="Permalink to this equation">#</a></span>\[\begin{equation}
x = \frac{b-a}{2}x' + \frac{b+a}{2},
\end{equation}\]</div>
<p>therefore</p>
<div class="amsmath math notranslate nohighlight" id="equation-42b6015f-737d-41e6-8738-fc38156dcaf8">
<span class="eqno">(18)<a class="headerlink" href="#equation-42b6015f-737d-41e6-8738-fc38156dcaf8" title="Permalink to this equation">#</a></span>\[\begin{equation}
\int_a^b f(x) dx \simeq \frac{b-a}{2} \sum w_k f\left(\frac{b-a}{2}x_k' + \frac{b+a}{2}\right),
\end{equation}\]</div>
<p>using both the <span class="math notranslate nohighlight">\(w_i\)</span> and <span class="math notranslate nohighlight">\(x_i'\)</span> from the method.</p>
<div class="exercise admonition" id="03-integration/NumericalIntegration_Basics-exercise-5">

<p class="admonition-title"><span class="caption-number">Exercise 6 </span> (Gauss - Legendre on general intervals)</p>
<section id="exercise-content">
<p>Extend the previous to compute the integral on a general interval <span class="math notranslate nohighlight">\([a, b]\)</span>. Test that it is still working for the original interval , and then compute the integral of <span class="math notranslate nohighlight">\(\sin(e^x)\)</span> for <span class="math notranslate nohighlight">\(x \in [-5.0, 5.0]\)</span>, using the two point Gauss-Legendre method. Compare with both trapezoid and simpson with 2 points. How many points do you need in thee methods to achieve a comparable precision as gauss legendre 2 points?</p>
</section>
</div>
</section>
<section id="higher-order-gauss-legendre-using-a-vector-to-store-the-weights-points">
<h2>Higher order Gauss-Legendre: using a vector to store the weights/points.<a class="headerlink" href="#higher-order-gauss-legendre-using-a-vector-to-store-the-weights-points" title="Link to this heading">#</a></h2>
<p>For an increasing number of points, you will need to use many variables to store the weights. For a degree <span class="math notranslate nohighlight">\(n=5\)</span>, you will need five variables to store the weights, five more for the points, and then manually process that. It will be much better to store them in an data structure that allow us to handle the operations in a generic way. In this case, it will be a <code class="docutils literal notranslate"><span class="pre">std::vector</span></code>, which allows us to store data, contiguously in memory, and process it using simple for loops (SIMD).</p>
<p>Our declaration could be</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span><span class="w"> </span><span class="nf">gauss_5</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">fptr</span><span class="w"> </span><span class="n">fun</span><span class="p">);</span>
</pre></div>
</div>
<p>and its implementation (you need to finish it)</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span><span class="w"> </span><span class="nf">gauss_5</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">fptr</span><span class="w"> </span><span class="n">fun</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span><span class="w"> </span><span class="c1">// store five points in the array</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span><span class="w"> </span><span class="c1">// store five weights in the array</span>
<span class="w">    </span><span class="c1">// initialize the data, sorted from left to right</span>
<span class="w">    </span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="o">/</span><span class="mi">7</span><span class="p">));</span>
<span class="w">    </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="o">/</span><span class="mi">7</span><span class="p">));</span>
<span class="w">    </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">    </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">322</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">13</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">900</span><span class="p">);</span>
<span class="w">    </span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">322</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">13</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">900</span><span class="p">);</span>
<span class="w">    </span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">128.0</span><span class="o">/</span><span class="mf">255.0</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="w">    </span><span class="c1">// compute the integral</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">fun</span><span class="p">((</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="o">*???</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Notice how easy is to process data in an array.</p>
<p>Now finish the implementation, and print the error, as a function of <span class="math notranslate nohighlight">\(x\)</span>, computing the err function, comparing the relative errors  with trapezoid, simpson, trapezoid+richardson, simpson+trapezoid, gauss_5. Plot it.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="gauss-quadrature-of-order-7">
<h3>Gauss quadrature of order 7<a class="headerlink" href="#gauss-quadrature-of-order-7" title="Link to this heading">#</a></h3>
<p>(REF: Sirca, Computational Methods in Physics. Also
<a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_quadrature">https://en.wikipedia.org/wiki/Gaussian_quadrature</a>)</p>
<p>The next table shows the points positions and weights for the Gaussian integral
of order 7, <span class="math notranslate nohighlight">\(G_7\)</span>,</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Nodes position</p></th>
<th class="head text-center"><p>Weigths</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\pm 0.949107912342759\)</span></p></td>
<td class="text-center"><p>0.129484966168870</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\pm 0.741531185599394\)</span></p></td>
<td class="text-center"><p>0.279705391489277</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\pm 0.405845151377397\)</span></p></td>
<td class="text-center"><p>0.381830050505119</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(0.000000000000000\)</span></p></td>
<td class="text-center"><p>0.417959183673469</p></td>
</tr>
</tbody>
</table>
</div>
<ol class="arabic">
<li><p>Implement the <span class="math notranslate nohighlight">\(G_7\)</span> method. Integrate the function <span class="math notranslate nohighlight">\(\sin\sqrt x\)</span> on the interval <span class="math notranslate nohighlight">\([2,
   8.7]\)</span>. The exact indefinite integral is <span class="math notranslate nohighlight">\(2\sin\sqrt x - 2\sqrt x\cos\sqrt x\)</span>.</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col  class="org-left" />
<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">G7:</td>
<td class="org-right">4.637955250321647</td>
</tr>
<tr>
<td class="org-left">Exact:</td>
<td class="org-right">4.637955200036554</td>
</tr>
</tbody>
</table>
</li>
<li><p>Compute the err function as a function of <span class="math notranslate nohighlight">\(x \in [0, 10.0]\)</span> in steps of
<span class="math notranslate nohighlight">\(0.05\)</span>, using both <span class="math notranslate nohighlight">\(G_7\)</span> and Simpson+Richardson and plot the relative
difference with the “exact” function <code class="docutils literal notranslate"><span class="pre">std::erf</span></code>
(<a class="reference external" href="https://en.cppreference.com/w/cpp/numeric/math/erf">https://en.cppreference.com/w/cpp/numeric/math/erf</a>).</p></li>
</ol>
<p>For more coefficients and higer orders, see <a class="reference external" href="https://pomax.github.io/bezierinfo/legendre-gauss.html">https://pomax.github.io/bezierinfo/legendre-gauss.html</a></p>
</section>
<section id="cumulative-probability">
<h3>Cumulative probability<a class="headerlink" href="#cumulative-probability" title="Link to this heading">#</a></h3>
<p>The probability density function for the <a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_distribution">Gamma distribution</a> is</p>
<div class="amsmath math notranslate nohighlight" id="equation-4713419f-73d4-4509-afb2-4f8aefce0192">
<span class="eqno">(19)<a class="headerlink" href="#equation-4713419f-73d4-4509-afb2-4f8aefce0192" title="Permalink to this equation">#</a></span>\[\begin{equation}
f(x; \alpha, \beta) = \frac{x^{\alpha -1} \cdot e^{-x/\beta} }{\beta^\alpha \cdot \Gamma(\alpha)},
\end{equation}\]</div>
<p>para <span class="math notranslate nohighlight">\(0 &lt; x &lt; \infty\)</span>. Compute and plot the cumulative density function, using
both the simpson method and the gaussian <span class="math notranslate nohighlight">\(g_7\)</span>, defined as</p>
<div class="amsmath math notranslate nohighlight" id="equation-824c1a2a-34cc-49da-8ead-2739229918a0">
<span class="eqno">(20)<a class="headerlink" href="#equation-824c1a2a-34cc-49da-8ead-2739229918a0" title="Permalink to this equation">#</a></span>\[\begin{equation}
F(x; \alpha, \beta) = \int_0^x dt f(t; \alpha, \beta),
\end{equation}\]</div>
<p>for <span class="math notranslate nohighlight">\(x \in [0.0, 20.0]\)</span>, with <span class="math notranslate nohighlight">\(\alpha = 7.5, \beta = 1.0\)</span>.</p>
</section>
<section id="di-logarithm-function">
<h3>Di-logarithm function<a class="headerlink" href="#di-logarithm-function" title="Link to this heading">#</a></h3>
<p>The di-logarithm function is defined as</p>
<div class="amsmath math notranslate nohighlight" id="equation-f7c280d1-1b48-48f3-89d9-ffb831045961">
<span class="eqno">(21)<a class="headerlink" href="#equation-f7c280d1-1b48-48f3-89d9-ffb831045961" title="Permalink to this equation">#</a></span>\[\begin{equation}
\mathrm{Li}_2(x) = -\int_0^x \frac{\ln(1-t)}{t} dt.
\end{equation}\]</div>
<p>Plot the di-logarithm function for <span class="math notranslate nohighlight">\(x \in (0.0, 1.0)\)</span>. If you use simpson,
always make sure that the error is less than <span class="math notranslate nohighlight">\(10^{-6}\)</span>. You might need to
transform the variable and/or split the integral to avoid numerical problems.</p>
</section>
<section id="moment-distribution">
<h3>Moment distribution<a class="headerlink" href="#moment-distribution" title="Link to this heading">#</a></h3>
<p>The kth moment for a probability distribution is</p>
<div class="amsmath math notranslate nohighlight" id="equation-171ca2a2-e692-4223-ac70-66978c7b9cca">
<span class="eqno">(22)<a class="headerlink" href="#equation-171ca2a2-e692-4223-ac70-66978c7b9cca" title="Permalink to this equation">#</a></span>\[\begin{equation}
\lt x^k \gt = \int x^k f(x) dx,
\end{equation}\]</div>
<p>Compute the first ten moments for the  <a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_distribution">Gamma distribution</a> ,</p>
<div class="amsmath math notranslate nohighlight" id="equation-db5e46d8-eada-4e21-bb43-a0bcc7025864">
<span class="eqno">(23)<a class="headerlink" href="#equation-db5e46d8-eada-4e21-bb43-a0bcc7025864" title="Permalink to this equation">#</a></span>\[\begin{equation}
f(x; \alpha, \beta) = \frac{\beta^\alpha}{\Gamma(\alpha) x^{\alpha -1} e^{-\beta x} }.
\end{equation}\]</div>
</section>
<section id="arch-lenght-mass-centroid">
<h3>Arch lenght, mass, centroid<a class="headerlink" href="#arch-lenght-mass-centroid" title="Link to this heading">#</a></h3>
<p>The arc length of a curve <span class="math notranslate nohighlight">\(y(x)\)</span> is given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-0d445b74-d187-47b8-9bd7-31c4784f607c">
<span class="eqno">(24)<a class="headerlink" href="#equation-0d445b74-d187-47b8-9bd7-31c4784f607c" title="Permalink to this equation">#</a></span>\[\begin{equation}
s = \int_a^b dx \sqrt{1 + \left(\frac{dy}{dx}  \right)^2}.
\end{equation}\]</div>
<p>If a linear body has a density <span class="math notranslate nohighlight">\(\rho(x)\)</span>, the total mass would be</p>
<div class="amsmath math notranslate nohighlight" id="equation-6b23984a-bae3-4e13-b6e6-fa29b7cbf3d9">
<span class="eqno">(25)<a class="headerlink" href="#equation-6b23984a-bae3-4e13-b6e6-fa29b7cbf3d9" title="Permalink to this equation">#</a></span>\[\begin{equation}
M = \int \rho(x) ds.
\end{equation}\]</div>
<p>The <span class="math notranslate nohighlight">\(x\)</span> position of the centroid can also be computed as</p>
<div class="amsmath math notranslate nohighlight" id="equation-9c61d823-4e90-41f2-9c6b-c2b6692c91a7">
<span class="eqno">(26)<a class="headerlink" href="#equation-9c61d823-4e90-41f2-9c6b-c2b6692c91a7" title="Permalink to this equation">#</a></span>\[\begin{equation}
\overline x = \frac{\int x\rho ds}{\int \rho ds}
\end{equation}\]</div>
<ol class="arabic simple">
<li><p>(Boas, Mathematical Physics) Compute the arch length for the catenary <span class="math notranslate nohighlight">\(y =
   \cosh x\)</span> between <span class="math notranslate nohighlight">\(x=-1\)</span> and <span class="math notranslate nohighlight">\(x=1\)</span>.</p></li>
<li><p>For a chain with shape <span class="math notranslate nohighlight">\(x^2\)</span>, with density <span class="math notranslate nohighlight">\(|x|\)</span>, between <span class="math notranslate nohighlight">\(x = -1\)</span> and <span class="math notranslate nohighlight">\(x=1\)</span>,
compute</p>
<ol class="arabic simple">
<li><p>The arc length</p></li>
<li><p>The total mass <span class="math notranslate nohighlight">\(M\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\overline x\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\overline y\)</span></p></li>
</ol>
</li>
</ol>
</section>
<section id="integrating-a-datafile">
<h3>Integrating a datafile<a class="headerlink" href="#integrating-a-datafile" title="Link to this heading">#</a></h3>
<p>The following data (file <code class="docutils literal notranslate"><span class="pre">accel.txt</span></code>) represents the acceleration of a car as a
function of time</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col  class="org-right" />
<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0.5</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-right">1.3</td>
<td class="org-right">3.6</td>
</tr>
<tr>
<td class="org-right">1.7</td>
<td class="org-right">4.4</td>
</tr>
<tr>
<td class="org-right">1.9</td>
<td class="org-right">4.15</td>
</tr>
<tr>
<td class="org-right">2.1</td>
<td class="org-right">3.85</td>
</tr>
<tr>
<td class="org-right">2.5</td>
<td class="org-right">3.25</td>
</tr>
<tr>
<td class="org-right">2.9</td>
<td class="org-right">2.65</td>
</tr>
</tbody>
</table>
<p>Save the data into the corresponding file. Then write a program to read the data
and compute the velocity as a function of time by integrating at each time step.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "iluvatar1/ProgCPP-lectures-jupyter",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./03-integration"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../02-derivatives/NumericalDifferentiation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Numerical differentiation</p>
      </div>
    </a>
    <a class="right-next"
       href="../04-vector-containers/ModernArrays.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Modern arrays</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trapezoidal-rule">Trapezoidal rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simpsons-rule">Simpsons rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#romberg-method">Romberg method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#other-techniques">Other techniques</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-quadrature-introduction-to-vectors">Gaussian quadrature: Introduction to vectors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deduction-of-points-and-weights-for-the-2-point-gauss-legendre-method">Deduction of points and weights for the 2 point Gauss-Legendre method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#method-1-the-exactness-method">Method 1: The Exactness Method</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#method-2-using-legendre-polynomials">Method 2: Using Legendre Polynomials</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scalling-integration-intervals">Scalling integration intervals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-order-gauss-legendre-using-a-vector-to-store-the-weights-points">Higher order Gauss-Legendre: using a vector to store the weights/points.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gauss-quadrature-of-order-7">Gauss quadrature of order 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cumulative-probability">Cumulative probability</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#di-logarithm-function">Di-logarithm function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#moment-distribution">Moment distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arch-lenght-mass-centroid">Arch lenght, mass, centroid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-a-datafile">Integrating a datafile</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By William Oquendo
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>